from subprocess import Popen, PIPE

class Unpack:
    def lookup_table(self, signature):
        if signature == 'UPX 0.50 - 0.70':
            return 'upx'
        elif signature == 'UPX v1.03 - v1.04':
            return 'upx'

    def upx(self, binary, dst):
        p = Popen(['upx', '-d', '-q', '-o', dst, '-k', binary], stdout=PIPE, stderr=PIPE)
        p.wait()
