#!/usr/bin/env python
import argparse
from fastscan.main import Main

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="simple masscan wrapper")
    parser.add_argument("range_dir", help="directory of ranges")
    parser.add_argument("port_file", help="file of port numbers")
    parser.add_argument("output", help="output file")
    parser.add_argument("--rate", default=100, help="ip per sec(DEFAULT: 100)")
    parser.add_argument("--iface", default="eth0", help="network interface")
    args = parser.parse_args()
    main = Main()
    main.run(args.range_dir, args.port_file, int(args.rate), args.iface, args.output)
